let productLocalStorage=JSON.parse(localStorage.getItem("cart"));if(productLocalStorage)for(let i=0;i<productLocalStorage.length;i++){let productArticle=document.createElement("article");document.querySelector("#cart__items").appendChild(productArticle),productArticle.className="cart__item",productArticle.setAttribute("data-id",productLocalStorage[i].idKanap);let productDivImg=document.createElement("div");productArticle.appendChild(productDivImg),productDivImg.className="cart__item__img";let productImg=document.createElement("img");productDivImg.appendChild(productImg),productImg.src=productLocalStorage[i].imgKanap;let productItemContent=document.createElement("div");productArticle.appendChild(productItemContent),productItemContent.className="cart__item__content";let productItemContentTitlePrice=document.createElement("div");productItemContent.appendChild(productItemContentTitlePrice),productItemContentTitlePrice.className="cart__item__content__titlePrice";let productTitle=document.createElement("h2");productItemContentTitlePrice.appendChild(productTitle),productTitle.innerHTML=productLocalStorage[i].nameKanap;let productColor=document.createElement("p");productTitle.appendChild(productColor),productColor.innerHTML=productLocalStorage[i].colorKanap,productColor.style.fontSize="20px";let productPrice=document.createElement("p");productItemContentTitlePrice.appendChild(productPrice),productPrice.innerHTML=productLocalStorage[i].priceKanap+" €";let productItemContentSettings=document.createElement("div");productItemContent.appendChild(productItemContentSettings),productItemContentSettings.className="cart__item__content__settings";let productItemContentSettingsQuantity=document.createElement("div");productItemContentSettings.appendChild(productItemContentSettingsQuantity),productItemContentSettingsQuantity.className="cart__item__content__settings__quantity";let productQty=document.createElement("p");productItemContentSettingsQuantity.appendChild(productQty),productQty.innerHTML="Qté : ";let productQuantity=document.createElement("input");productItemContentSettingsQuantity.appendChild(productQuantity),productQuantity.value=productLocalStorage[i].qtyKanap,productQuantity.className="itemQuantity",productQuantity.setAttribute("type","number"),productQuantity.setAttribute("min","1"),productQuantity.setAttribute("max","100"),productQuantity.setAttribute("name","itemQuantity");let productItemContentSettingsDelete=document.createElement("div");productItemContentSettings.appendChild(productItemContentSettingsDelete),productItemContentSettingsDelete.className="cart__item__content__settings__delete";let productSupprimer=document.createElement("p");productItemContentSettingsDelete.appendChild(productSupprimer),productSupprimer.className="deleteItem",productSupprimer.innerHTML="Supprimer",productSupprimer.addEventListener("click",e=>{e.preventDefault;let deleteId=productLocalStorage[i].idKanap,deleteColor=productLocalStorage[i].colorKanap;productLocalStorage=productLocalStorage.filter(elt=>elt.idKanap!==deleteId||elt.colorKanap!==deleteColor),localStorage.setItem("cart",JSON.stringify(productLocalStorage)),alert("Votre article a bien été supprimé."),0===productLocalStorage.length&&localStorage.clear(),location.reload()})}else{const titleCart=document.querySelector("h1"),sectionCart=document.querySelector(".cart");titleCart.innerHTML="Votre panier est vide !",sectionCart.style.display="none"}function getTotals(){for(var elemsQtt=document.getElementsByClassName("itemQuantity"),myLength=elemsQtt.length,totalQtt=0,i=0;i<myLength;++i)totalQtt+=elemsQtt[i].valueAsNumber;let productTotalQuantity,productTotalPrice;document.getElementById("totalQuantity").innerHTML=totalQtt,totalPrice=0;for(var i=0;i<myLength;++i)totalPrice+=elemsQtt[i].valueAsNumber*productLocalStorage[i].priceKanap;document.getElementById("totalPrice").innerHTML=totalPrice}function modifyQtt(){let qttModif=document.querySelectorAll(".itemQuantity");for(let k=0;k<qttModif.length;k++)qttModif[k].addEventListener("change",event=>{event.preventDefault();let quantityModif=productLocalStorage[k].qtyKanap,qttModifValue=qttModif[k].valueAsNumber;const resultFind=productLocalStorage.find(el=>el.qttModifValue!==quantityModif);resultFind.qtyKanap=qttModifValue,productLocalStorage[k].qtyKanap=resultFind.qtyKanap,localStorage.setItem("cart",JSON.stringify(productLocalStorage)),location.reload()})}function getForm(){let form=document.querySelector(".cart__order__form"),emailRegExp=new RegExp("^[a-zA-Z0-9.-_]+[@]{1}[a-zA-Z0-9.-_]+[.]{1}[a-z]{2,10}$"),charRegExp=new RegExp("^[a-zA-Z ,.'-]+$"),addressRegExp=new RegExp("^[0-9]{1,3}(?:(?:[,. ]){1}[-a-zA-Zàâäéèêëïîôöùûüç]+)+");form.firstName.addEventListener("change",(function(){validFirstName(this)})),form.lastName.addEventListener("change",(function(){validLastName(this)})),form.address.addEventListener("change",(function(){validAddress(this)})),form.city.addEventListener("change",(function(){validCity(this)})),form.email.addEventListener("change",(function(){validEmail(this)}));const validFirstName=function(inputFirstName){let firstNameErrorMsg=inputFirstName.nextElementSibling;charRegExp.test(inputFirstName.value)?firstNameErrorMsg.innerHTML="":firstNameErrorMsg.innerHTML="Veuillez renseigner ce champ."},validLastName=function(inputLastName){let lastNameErrorMsg=inputLastName.nextElementSibling;charRegExp.test(inputLastName.value)?lastNameErrorMsg.innerHTML="":lastNameErrorMsg.innerHTML="Veuillez renseigner ce champ."},validAddress=function(inputAddress){let addressErrorMsg=inputAddress.nextElementSibling;addressRegExp.test(inputAddress.value)?addressErrorMsg.innerHTML="":addressErrorMsg.innerHTML="Veuillez renseigner ce champ."},validCity=function(inputCity){let cityErrorMsg=inputCity.nextElementSibling;charRegExp.test(inputCity.value)?cityErrorMsg.innerHTML="":cityErrorMsg.innerHTML="Veuillez renseigner ce champ."},validEmail=function(inputEmail){let emailErrorMsg=inputEmail.nextElementSibling;emailRegExp.test(inputEmail.value)?emailErrorMsg.innerHTML="":emailErrorMsg.innerHTML="Veuillez renseigner votre email."}}function postForm(){const order=document.getElementById("order");order.addEventListener("click",event=>{event.preventDefault();const contact={firstName:document.getElementById("firstName").value,lastName:document.getElementById("lastName").value,address:document.getElementById("address").value,city:document.getElementById("city").value,email:document.getElementById("email").value};let products=[];for(let i=0;i<productLocalStorage.length;i++)products.push(productLocalStorage[i].idKanap);console.log(products);const sendFormData={contact:contact,products:products},options={method:"POST",body:JSON.stringify(sendFormData),headers:{"Content-Type":"application/json"}};fetch("http://localhost:3000/api/products/order",options).then(response=>response.json()).then(data=>{localStorage.setItem("orderId",data.orderId),document.location.href="confirmation.html?id="+data.orderId})})}getTotals(),modifyQtt(),getForm(),postForm();
//# sourceMappingURL=cart.min.js.map